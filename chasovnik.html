<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Време на един екран</title>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
            color: white;
            font-family: 'Segoe UI', sans-serif;
            margin: 0;
            padding: 0;
            /* ГАРАНТИРА, че няма да има скрол */
            height: 100vh;
            width: 100vw;
            overflow: hidden;
        }

        .container {
            /* Това е тайната: Flexbox разпъва елементите по цялата височина */
            display: flex;
            flex-direction: column;
            justify-content: space-evenly; /* Равно разстояние между всичко */
            align-items: center;
            height: 100%; /* Заема целия екран */
            width: 100%;
            padding: 2vh 5vw; /* Малко отстояние от краищата */
            text-align: center;
        }

        /* ИЗПОЛЗВАМ 'vmin' - това прави размера перфектен и за портрет, и за пейзаж */

        select {
            font-size: 5vmin;
            padding: 1vmin 4vmin;
            border-radius: 50px;
            border: 1px solid rgba(255,255,255,0.3);
            background: rgba(0, 0, 0, 0.3);
            color: white;
            outline: none;
            text-align: center;
            -webkit-appearance: none;
            font-weight: bold;
            width: 80%;
        }

        .clock {
            font-size: 24vmin; /* ОГРОМЕН ЧАСОВНИК, но съобразен с екрана */
            font-weight: 700;
            line-height: 0.9;
            font-variant-numeric: tabular-nums;
            margin: 0; /* Махаме старите отстояния, Flexbox ще ги нагласи */
        }

        .date {
            font-size: 5vmin;
            color: #d7d7d7;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin: 0;
        }

        .temp-box {
            font-size: 16vmin;
            font-weight: bold;
            margin: 0;
        }

        .details {
            display: flex;
            justify-content: space-between;
            width: 90%;
            border-top: 1px solid rgba(255,255,255,0.2);
            padding-top: 2vmin;
        }

        .detail-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .detail-val {
            font-size: 6vmin;
            font-weight: bold;
        }

        .detail-label {
            font-size: 3vmin;
            opacity: 0.7;
            text-transform: uppercase;
        }

        option { color: black; }
    </style>
</head>
<body>

    <div class="container">
        <select id="city-select" onchange="getWeather()">
            <option value="sofia">София</option>
            <option value="plovdiv">Пловдив</option>
            <option value="varna">Варна</option>
            <option value="burgas">Бургас</option>
            <option value="ruse">Русе</option>
            <option value="stara_zagora">Ст. Загора</option>
            <option value="pleven">Плевен</option>
            <option value="blagoevgrad">Благоевград</option>
        </select>

        <div class="clock" id="clock">00:00</div>

        <div class="date" id="date">...</div>

        <div class="temp-box" id="main-temp">--°</div>

        <div class="details">
            <div class="detail-item">
                <span class="detail-val" id="humidity">--%</span>
                <span class="detail-label">Влажност</span>
            </div>
            <div class="detail-item">
                <span class="detail-val" id="wind">--</span>
                <span class="detail-label">Вятър (км/ч)</span>
            </div>
        </div>
    </div>

    <script>
        let timeOffset = 0;

        const cities = {
            sofia: { lat: 42.6977, lon: 23.3219 },
            plovdiv: { lat: 42.1354, lon: 24.7453 },
            varna: { lat: 43.2141, lon: 27.9147 },
            burgas: { lat: 42.5048, lon: 27.4626 },
            ruse: { lat: 43.8356, lon: 25.9657 },
            stara_zagora: { lat: 42.4328, lon: 25.6419 },
            pleven: { lat: 43.4170, lon: 24.6067 },
            blagoevgrad: { lat: 42.0118, lon: 23.0899 }
        };

        // Умна синхронизация
        async function smartSync() {
            try {
                const response = await fetch('https://worldtimeapi.org/api/timezone/Europe/Sofia', { cache: "no-store", mode: 'cors' });
                if (response.ok) {
                    const data = await response.json();
                    timeOffset = new Date(data.datetime).getTime() - new Date().getTime();
                }
            } catch (error) { timeOffset = 0; }
        }

        // Часовник (махаме секундите, за да е по-едро и чисто, ако искате секунди - кажете)
        function updateClock() {
            const now = new Date(new Date().getTime() + timeOffset);

            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0'); // Добавям секунди

            // Ако екранът е много тесен, секундите може да паднат на нов ред.
            // Затова тук ги оставям, но CSS-ът ще се погрижи да се съберат.
            document.getElementById('clock').innerText = `${hours}:${minutes}:${seconds}`;

            const options = { weekday: 'long', day: 'numeric', month: 'short' };
            document.getElementById('date').innerText = now.toLocaleDateString('bg-BG', options);
        }

        async function getWeather() {
            try {
                const selectedCity = document.getElementById('city-select').value;
                const coords = cities[selectedCity];
                const url = `https://api.open-meteo.com/v1/forecast?latitude=${coords.lat}&longitude=${coords.lon}&current=temperature_2m,relative_humidity_2m,wind_speed_10m`;

                const response = await fetch(url);
                const data = await response.json();
                const current = data.current;

                document.getElementById('main-temp').innerText = `${Math.round(current.temperature_2m)}°`;
                document.getElementById('humidity').innerText = `${current.relative_humidity_2m}%`;
                document.getElementById('wind').innerText = `${Math.round(current.wind_speed_10m)}`;

            } catch (error) {
                document.getElementById('main-temp').innerText = "--";
            }
        }

        smartSync();
        setInterval(smartSync, 600000);
        setInterval(updateClock, 1000);
        updateClock();
        getWeather();
        setInterval(getWeather, 600000);
    </script>

</body>
</html>
