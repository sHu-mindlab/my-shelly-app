<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Време и Климат</title>
    <style>
        body {
            /* Тъмносин фон с лек градиент */
            background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
            color: white;
            font-family: 'Segoe UI', Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            text-align: center;
        }

        .container {
            padding: 20px;
            text-shadow: 0 4px 10px rgba(0,0,0,0.5);
        }

        /* Меню за избор на град - изчистено */
        select {
            font-size: 22px;
            padding: 10px 30px;
            border-radius: 30px;
            border: 1px solid rgba(255,255,255,0.2);
            background: rgba(0, 0, 0, 0.4);
            color: white;
            cursor: pointer;
            margin-bottom: 20px;
            outline: none;
            text-align: center;
            -webkit-appearance: none;
            -moz-appearance: none;
            font-weight: bold;
        }
        
        select:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        select option {
            background-color: #203a43;
            color: white;
        }

        .clock {
            font-size: 130px; /* Леко увеличен за акцент */
            font-weight: 700;
            line-height: 1;
            margin-bottom: 10px;
            font-variant-numeric: tabular-nums; 
        }

        .date {
            font-size: 26px;
            margin-bottom: 50px;
            color: #d7d7d7;
            text-transform: uppercase;
            letter-spacing: 3px;
        }

        .temp-box {
            font-size: 80px;
            font-weight: bold;
            margin-bottom: 30px;
        }

        .details {
            font-size: 24px;
            display: flex;
            justify-content: center;
            gap: 60px;
            color: #e5e9f0;
        }

        .detail-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }
        
        .detail-label {
            font-size: 14px;
            opacity: 0.6;
            text-transform: uppercase;
        }
    </style>
</head>
<body>

    <div class="container">
        <select id="city-select" onchange="getWeather()">
            <option value="sofia">София</option>
            <option value="plovdiv">Пловдив</option>
            <option value="varna">Варна</option>
            <option value="burgas">Бургас</option>
            <option value="ruse">Русе</option>
            <option value="stara_zagora">Стара Загора</option>
            <option value="pleven">Плевен</option>
            <option value="blagoevgrad">Благоевград</option>
        </select>

        <div class="clock" id="clock">00:00:00</div>
        
        <div class="date" id="date">...</div>

        <div class="temp-box" id="main-temp">--°C</div>

        <div class="details">
            <div class="detail-item">
                <span id="humidity">--%</span>
                <span class="detail-label">Влажност</span>
            </div>
            <div class="detail-item">
                <span id="wind">-- км/ч</span>
                <span class="detail-label">Вятър</span>
            </div>
        </div>
    </div>

    <script>
        // --- ГЛОБАЛНИ ПРОМЕНЛИВИ ---
        let timeOffset = 0; 
        
        // --- 1. КООРДИНАТИ ---
        const cities = {
            sofia: { lat: 42.6977, lon: 23.3219 },
            plovdiv: { lat: 42.1354, lon: 24.7453 },
            varna: { lat: 43.2141, lon: 27.9147 },
            burgas: { lat: 42.5048, lon: 27.4626 },
            ruse: { lat: 43.8356, lon: 25.9657 },
            stara_zagora: { lat: 42.4328, lon: 25.6419 },
            pleven: { lat: 43.4170, lon: 24.6067 },
            blagoevgrad: { lat: 42.0118, lon: 23.0899 }
        };

        // --- 2. СКРИТА СИНХРОНИЗАЦИЯ ---
        async function smartSync() {
            try {
                // Опитваме да вземем време от интернет
                const response = await fetch('https://worldtimeapi.org/api/timezone/Europe/Sofia', { 
                    cache: "no-store",
                    mode: 'cors'
                });
                
                if (response.ok) {
                    const data = await response.json();
                    const serverTime = new Date(data.datetime).getTime();
                    const localTime = new Date().getTime();
                    timeOffset = serverTime - localTime;
                }
            } catch (error) {
                // Ако не стане - не правим нищо (оставаме на локално време), без съобщение
                timeOffset = 0;
            }
        }

        // --- 3. ЧАСОВНИК ---
        function updateClock() {
            const now = new Date(new Date().getTime() + timeOffset);
            
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            
            document.getElementById('clock').innerText = `${hours}:${minutes}:${seconds}`;
            
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('date').innerText = now.toLocaleDateString('bg-BG', options);
        }

        // --- 4. ВРЕМЕТО (КЛИМАТ) ---
        async function getWeather() {
            try {
                const selectedCity = document.getElementById('city-select').value;
                const coords = cities[selectedCity];

                const url = `https://api.open-meteo.com/v1/forecast?latitude=${coords.lat}&longitude=${coords.lon}&current=temperature_2m,relative_humidity_2m,wind_speed_10m`;
                
                const response = await fetch(url);
                const data = await response.json();
                const current = data.current;

                document.getElementById('main-temp').innerText = `${Math.round(current.temperature_2m)}°C`;
                document.getElementById('humidity').innerText = `${current.relative_humidity_2m}%`;
                document.getElementById('wind').innerText = `${Math.round(current.wind_speed_10m)} км/ч`;

            } catch (error) {
                document.getElementById('main-temp').innerText = "--";
            }
        }

        // --- СТАРТИРАНЕ ---
        smartSync(); 
        setInterval(smartSync, 600000); // Тиха синхронизация

        setInterval(updateClock, 1000); 
        updateClock(); 

        getWeather();
        setInterval(getWeather, 600000);
    </script>

</body>
</html>
