<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Часовник за Телефон</title>
    <style>
        body {
            background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
            color: white;
            font-family: 'Segoe UI', Helvetica, Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh; /* Пълна височина */
            width: 100vw;  /* Пълна ширина */
            margin: 0;
            text-align: center;
            overflow: hidden; /* Спира скролването */
            touch-action: none; /* Подобрява реакцията при докосване */
        }

        .container {
            width: 90%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }

        /* АДАПТИВНО МЕНЮ */
        select {
            /* Шрифтът е 6% от ширината на екрана, но не по-малък от 18px */
            font-size: max(18px, 6vw); 
            padding: 10px 20px;
            border-radius: 50px;
            border: 1px solid rgba(255,255,255,0.3);
            background: rgba(0, 0, 0, 0.4);
            color: white;
            margin-bottom: 5vh; /* 5% от височината на екрана */
            outline: none;
            text-align: center;
            -webkit-appearance: none;
            font-weight: bold;
            width: 80%;
        }

        /* АДАПТИВЕН ЧАСОВНИК */
        .clock {
            /* 21% от ширината на екрана - гарантира, че се събира на един ред */
            font-size: 21vw; 
            font-weight: 700;
            line-height: 1;
            margin-bottom: 1vh;
            font-variant-numeric: tabular-nums; 
        }

        .date {
            font-size: 5vw;
            margin-bottom: 4vh;
            color: #d7d7d7;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .temp-box {
            font-size: 15vw;
            font-weight: bold;
            margin-bottom: 3vh;
        }

        .details {
            display: flex;
            justify-content: space-between;
            width: 90%; /* Разпъва детайлите */
            color: #e5e9f0;
        }

        .detail-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Стойностите на вятър/влажност */
        .detail-val {
            font-size: 6vw;
            font-weight: bold;
        }
        
        /* Етикетите (Влажност/Вятър) */
        .detail-label {
            font-size: 3.5vw;
            opacity: 0.7;
            text-transform: uppercase;
            margin-top: 5px;
        }
    </style>
</head>
<body>

    <div class="container">
        <select id="city-select" onchange="getWeather()">
            <option value="sofia">София</option>
            <option value="plovdiv">Пловдив</option>
            <option value="varna">Варна</option>
            <option value="burgas">Бургас</option>
            <option value="ruse">Русе</option>
            <option value="stara_zagora">Стара Загора</option>
            <option value="pleven">Плевен</option>
            <option value="blagoevgrad">Благоевград</option>
        </select>

        <div class="clock" id="clock">00:00:00</div>
        
        <div class="date" id="date">...</div>

        <div class="temp-box" id="main-temp">--°C</div>

        <div class="details">
            <div class="detail-item">
                <span class="detail-val" id="humidity">--%</span>
                <span class="detail-label">Влажност</span>
            </div>
            <div class="detail-item">
                <span class="detail-val" id="wind">-- км/ч</span>
                <span class="detail-label">Вятър</span>
            </div>
        </div>
    </div>

    <script>
        // --- СЪЩАТА ЛОГИКА КАТО ПРЕДИ (Работи перфектно) ---
        let timeOffset = 0; 
        
        const cities = {
            sofia: { lat: 42.6977, lon: 23.3219 },
            plovdiv: { lat: 42.1354, lon: 24.7453 },
            varna: { lat: 43.2141, lon: 27.9147 },
            burgas: { lat: 42.5048, lon: 27.4626 },
            ruse: { lat: 43.8356, lon: 25.9657 },
            stara_zagora: { lat: 42.4328, lon: 25.6419 },
            pleven: { lat: 43.4170, lon: 24.6067 },
            blagoevgrad: { lat: 42.0118, lon: 23.0899 }
        };

        async function smartSync() {
            try {
                const response = await fetch('https://worldtimeapi.org/api/timezone/Europe/Sofia', { 
                    cache: "no-store",
                    mode: 'cors'
                });
                if (response.ok) {
                    const data = await response.json();
                    timeOffset = new Date(data.datetime).getTime() - new Date().getTime();
                }
            } catch (error) { timeOffset = 0; }
        }

        function updateClock() {
            const now = new Date(new Date().getTime() + timeOffset);
            
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            
            document.getElementById('clock').innerText = `${hours}:${minutes}:${seconds}`;
            
            const options = { weekday: 'long', day: 'numeric', month: 'long' };
            document.getElementById('date').innerText = now.toLocaleDateString('bg-BG', options);
        }

        async function getWeather() {
            try {
                const selectedCity = document.getElementById('city-select').value;
                const coords = cities[selectedCity];

                const url = `https://api.open-meteo.com/v1/forecast?latitude=${coords.lat}&longitude=${coords.lon}&current=temperature_2m,relative_humidity_2m,wind_speed_10m`;
                
                const response = await fetch(url);
                const data = await response.json();
                const current = data.current;

                document.getElementById('main-temp').innerText = `${Math.round(current.temperature_2m)}°C`;
                document.getElementById('humidity').innerText = `${current.relative_humidity_2m}%`;
                document.getElementById('wind').innerText = `${Math.round(current.wind_speed_10m)} км/ч`;

            } catch (error) {
                document.getElementById('main-temp').innerText = "--";
            }
        }

        smartSync(); 
        setInterval(smartSync, 600000); 

        setInterval(updateClock, 1000); 
        updateClock(); 

        getWeather();
        setInterval(getWeather, 600000);
    </script>

</body>
</html>
